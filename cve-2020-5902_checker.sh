#!/bin/bash
clear
echo "###############################################################"
echo "# CVE-2020-5902 CHECKER                                       #"
echo "###############################################################"
echo ""

echo "TARGET IP/CIDR RANGE?"
read RANGE

TARGETS = "targets.txt"

echo "GENERATING LIST OF DETECTED F5 BIG IP DEVICES..."
nmap -p443 $RANGE --script=http-vuln-cve2020-5902.nse -oG - | awk '/Up$/{print $2}' > $TARGETS

echo "LIST GENERATED"

sleep 3

echo "SCANNING LIST OF TARGETS FOR VULNERABLE DEVICES"
nuclei -t ~/Github/Nuclei/Nuclei-templates/cves/CVE-2020-5902.yaml -l $TARGETS

# Another way for the nmap IP filtering:
# | awk '/is up/ {print up}; {gsub (/\(|\)/,""); up = $NF}'

exit 0

